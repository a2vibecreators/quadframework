# QUAD Framework - Complete Sitemap & Navigation Flows

**Last Updated:** January 4, 2026

This document provides a comprehensive map of all pages, authentication flows, and navigation paths in the QUAD Framework website.

---

## Table of Contents

1. [Public Pages (Non-Logged-In Users)](#public-pages-non-logged-in-users)
2. [Authentication Flows](#authentication-flows)
3. [Protected Pages (Logged-In Users)](#protected-pages-logged-in-users)
4. [API Endpoints](#api-endpoints)

---

## Public Pages (Non-Logged-In Users)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PUBLIC SITE MAP                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

HOME (/)
â”œâ”€â”€ EXPLORE Flow (Learn QUAD Concepts)
â”‚   â”œâ”€â”€ /concept â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ QUAD Methodology Overview
â”‚   â”œâ”€â”€ /details â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Detailed QUAD Breakdown
â”‚   â”œâ”€â”€ /architecture â”€â”€â”€â”€â”€â”€â”€ System Architecture
â”‚   â”œâ”€â”€ /flow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Flow Visualization
â”‚   â”œâ”€â”€ /circles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 4 Circles Explanation
â”‚   â”œâ”€â”€ /cycles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Cycles & Pulses
â”‚   â”œâ”€â”€ /flows â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Work Item Flows
â”‚   â”œâ”€â”€ /roles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Role Definitions
â”‚   â”œâ”€â”€ /mastery â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Adoption Matrix
â”‚   â””â”€â”€ /jargons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Terminology Guide
â”‚
â”œâ”€â”€ TRY Flow (Interactive Tools)
â”‚   â”œâ”€â”€ /demo â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Interactive Dashboard Demo
â”‚   â”œâ”€â”€ /quiz â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Knowledge Quiz
â”‚   â”œâ”€â”€ /configure â”€â”€â”€â”€â”€â”€â”€â”€â”€ QUAD Config Generator
â”‚   â”œâ”€â”€ /discovery â”€â”€â”€â”€â”€â”€â”€â”€â”€ Discovery Wizard
â”‚   â””â”€â”€ /compare â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Compare with Other Methodologies
â”‚
â”œâ”€â”€ RESOURCES Flow (Reference Materials)
â”‚   â”œâ”€â”€ /cheatsheet â”€â”€â”€â”€â”€â”€â”€â”€ Quick Reference Guide
â”‚   â”œâ”€â”€ /book â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Download QUAD Book
â”‚   â”œâ”€â”€ /docs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Documentation Hub
â”‚   â”œâ”€â”€ /sitemap â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Site Navigation Map
â”‚   â”œâ”€â”€ /support â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get Help
â”‚   â””â”€â”€ /case-study â”€â”€â”€â”€â”€â”€â”€â”€ Real-World Case Studies
â”‚
â”œâ”€â”€ PLATFORM (Product Pages)
â”‚   â”œâ”€â”€ /platform â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ QUAD Platform Overview
â”‚   â”œâ”€â”€ /pitch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Product Pitch
â”‚   â”œâ”€â”€ /mm-pitch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Mass Mutual Demo Pitch
â”‚   â”œâ”€â”€ /blueprint-agent â”€â”€â”€ Blueprint Agent Feature
â”‚   â””â”€â”€ /onboarding â”€â”€â”€â”€â”€â”€â”€â”€ Team Onboarding Guide
â”‚
â””â”€â”€ AUTHENTICATION (Login/Signup)
    â”œâ”€â”€ /auth/login â”€â”€â”€â”€â”€â”€â”€â”€ Login Page â†’ See "Login Flows" below
    â””â”€â”€ /auth/signup â”€â”€â”€â”€â”€â”€â”€ Signup Page â†’ See "Signup Flows" below
```

---

## Authentication Flows

### 1. Login Flows (Existing Users)

#### Login Flow A: OAuth (Google/GitHub)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LOGIN FLOW A: OAuth (Google/GitHub) - Existing User               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/auth/login
    â”‚
    â”‚ 1. Click "Continue with Google"
    â–¼
[Google OAuth Consent Screen]
    â”‚
    â”‚ 2. User approves â†’ Google redirects back
    â–¼
/api/auth/callback/google
    â”‚
    â”‚ 3. NextAuth callback (authOptions.ts signIn)
    â”‚    - Calls getUserByEmail(email)
    â”‚    - User exists? â†’ YES
    â”‚    - Return '/dashboard'
    â–¼
/dashboard âœ…
    â”‚
    â””â”€â†’ User is now logged in with OAuth session
```

#### Login Flow B: Email + Verification Code

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LOGIN FLOW B: Email + Verification Code - Existing User           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/auth/login
    â”‚
    â”‚ 1. Click "Email / Code" button
    â–¼
[Email Input Form]
    â”‚
    â”‚ 2. Enter email â†’ Click "Send code"
    â–¼
POST /api/auth/send-code
    â”‚
    â”‚ 3. Backend sends 6-digit code to email
    â”‚    - Checks if user exists
    â”‚    - Generates OTP
    â”‚    - Sends email
    â–¼
[Verification Code Input]
    â”‚
    â”‚ 4. User enters 6-digit code from email
    â–¼
POST /api/auth/verify-code
    â”‚
    â”‚ 5. Backend verifies code
    â”‚    â”œâ”€ Valid code + Existing user? â†’ Creates session token
    â”‚    â””â”€ Valid code + New user? â†’ Redirect to signup
    â–¼
/dashboard âœ… (existing user)
    â”‚
    OR
    â”‚
/auth/signup?verified=true&email=... (new user)
```

### 2. Signup Flows (New Users)

#### Signup Flow A: OAuth (Google/GitHub)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SIGNUP FLOW A: OAuth (Google/GitHub) - New User                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/auth/signup
    â”‚
    â”‚ 1. Click "Continue with Google"
    â–¼
[Google OAuth Consent Screen]
    â”‚
    â”‚ 2. User approves â†’ Google redirects back
    â–¼
/api/auth/callback/google
    â”‚
    â”‚ 3. NextAuth callback (authOptions.ts signIn)
    â”‚    - Calls getUserByEmail(email)
    â”‚    - User exists? â†’ NO (404)
    â”‚    - Return '/auth/signup?oauth=true&provider=google&email=...&name=...'
    â–¼
/auth/signup?oauth=true&provider=google&email=user@gmail.com&name=John
    â”‚
    â”‚ 4. Signup page shows account type selection
    â”‚    [ğŸš€ Startup] [ğŸ“ˆ Business] [ğŸ¢ Enterprise]
    â”‚
    â”‚ 5. User selects "Startup" (instant access)
    â–¼
[Signup Form Pre-filled]
    - Email: user@gmail.com (read-only, verified via OAuth)
    - Name: John (read-only, from Google)
    - Company: Optional
    â”‚
    â”‚ 6. User submits form
    â–¼
POST /api/auth/complete-oauth-signup
    â”‚
    â”‚ 7. Backend creates:
    â”‚    - Organization (e.g., "John's Team")
    â”‚    - User account (role: ADMIN)
    â”‚    - Links OAuth provider
    â–¼
{success: true}
    â”‚
    â”‚ 8. Frontend calls signIn('google') AGAIN
    â”‚    (Second OAuth roundtrip to create NextAuth session)
    â–¼
/api/auth/callback/google (2nd time)
    â”‚
    â”‚ 9. NextAuth callback
    â”‚    - Calls getUserByEmail(email)
    â”‚    - User exists? â†’ YES (just created)
    â”‚    - Return '/dashboard'
    â–¼
/dashboard âœ…
    â”‚
    â””â”€â†’ User is now logged in with full account setup
```

#### Signup Flow B: Email + Verification Code

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SIGNUP FLOW B: Email + Verification Code - New User               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/auth/login
    â”‚
    â”‚ 1. Click "Email / Code" â†’ Enter email â†’ Get code
    â–¼
POST /api/auth/verify-code
    â”‚
    â”‚ 2. Backend verifies code
    â”‚    - User exists? â†’ NO
    â”‚    - Redirect to signup with verified email flag
    â–¼
/auth/signup?verified=true&email=user@company.com
    â”‚
    â”‚ 3. Signup page shows account type selection
    â”‚    [ğŸš€ Startup] [ğŸ“ˆ Business] [ğŸ¢ Enterprise]
    â”‚
    â”‚ 4. User selects account type
    â–¼
[Signup Form]
    - Email: user@company.com (read-only, verified via OTP)
    - Name: (user must enter)
    - Company: (optional for Startup)
    â”‚
    â”‚ 5. User submits form
    â–¼
POST /api/auth/signup
    â”‚
    â”‚ 6. Backend creates:
    â”‚    - Organization
    â”‚    - User account (no password - passwordless)
    â”‚    - Marks email as verified
    â–¼
{success: true, token: "..."}
    â”‚
    â”‚ 7. Frontend stores token â†’ Redirect to dashboard
    â–¼
/dashboard âœ…
```

### 3. Edge Cases & Special Flows

#### Edge Case A: Existing User Clicks "Sign Up" (OAuth)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EDGE CASE A: Existing User Clicks "Sign Up" with OAuth            â”‚
â”‚ âœ… FIXED: Now redirects to dashboard instead of signup loop       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/auth/signup
    â”‚
    â”‚ 1. EXISTING user clicks "Continue with Google"
    â”‚    (User already has account but clicked wrong button)
    â–¼
[Google OAuth Consent Screen]
    â”‚
    â”‚ 2. User approves â†’ Google redirects back
    â–¼
/api/auth/callback/google
    â”‚
    â”‚ 3. NextAuth callback (authOptions.ts signIn)
    â”‚    - Calls getUserByEmail(email)
    â”‚    - User exists? â†’ YES
    â”‚    - Return '/dashboard' âœ… (FIXED - was returning true)
    â–¼
/dashboard âœ…
    â”‚
    â””â”€â†’ User goes directly to dashboard (onboarding already done)

BEFORE FIX: Would redirect back to /auth/signup â†’ confusing loop
AFTER FIX: Redirects to /dashboard â†’ correct behavior
```

#### Edge Case B: User Logs Out and Signs In Again

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EDGE CASE B: User Logs Out â†’ Signs In Again                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/dashboard
    â”‚
    â”‚ 1. User clicks "Logout"
    â–¼
POST /api/auth/logout
    â”‚
    â”‚ 2. NextAuth destroys session â†’ Redirect to login
    â–¼
/auth/login
    â”‚
    â”‚ 3. User clicks "Continue with Google" (or Email/Code)
    â–¼
[OAuth or OTP Flow - See "Login Flow A" or "Login Flow B"]
    â”‚
    â”‚ 4. User exists â†’ Skip signup â†’ Direct to dashboard
    â–¼
/dashboard âœ…
    â”‚
    â””â”€â†’ User is logged in again (no re-onboarding)
```

---

## Protected Pages (Logged-In Users)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PROTECTED PAGES (Requires Auth)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/dashboard (Main Hub)
    â”‚
    â”œâ”€â”€ Header
    â”‚   â”œâ”€â”€ Company Logo (quadframe.work)
    â”‚   â”œâ”€â”€ User Avatar + Dropdown
    â”‚   â”‚   â”œâ”€â”€ Profile
    â”‚   â”‚   â”œâ”€â”€ Settings
    â”‚   â”‚   â””â”€â”€ Logout
    â”‚   â””â”€â”€ "Back to Home" link â†’ /
    â”‚
    â”œâ”€â”€ Domains Section
    â”‚   â”œâ”€â”€ [Create New Domain] â†’ POST /api/domains/create
    â”‚   â””â”€â”€ Domain Cards (for each domain)
    â”‚       â”œâ”€â”€ View Details â†’ /domains/[id]
    â”‚       â”œâ”€â”€ Start Blueprint Agent â†’ /blueprint-agent?domainId=...
    â”‚       â””â”€â”€ Manage Members â†’ /domains/[id]/members
    â”‚
    â”œâ”€â”€ Quick Actions
    â”‚   â”œâ”€â”€ [Create Ticket] â†’ /tickets/create
    â”‚   â”œâ”€â”€ [View My Tickets] â†’ /tickets?assignee=me
    â”‚   â””â”€â”€ [Team Activity] â†’ /activity
    â”‚
    â””â”€â”€ Footer Navigation
        â”œâ”€â”€ /setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Initial Setup Wizard
        â”œâ”€â”€ /configure â”€â”€â”€â”€â”€â”€â”€â”€â”€ Configuration Pages
        â”œâ”€â”€ /reporting â”€â”€â”€â”€â”€â”€â”€â”€â”€ Analytics Dashboard
        â””â”€â”€ /tools â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Tool Management

/domains
    â”œâ”€â”€ /domains/list â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ View all domains (API)
    â”œâ”€â”€ /domains/create â”€â”€â”€â”€â”€â”€â”€â”€ Create new domain
    â””â”€â”€ /domains/[id]
        â”œâ”€â”€ Overview Tab
        â”œâ”€â”€ Members Tab â”€â”€â”€â”€â”€â”€â”€â”€ /domains/[id]/members
        â”œâ”€â”€ Circles Tab â”€â”€â”€â”€â”€â”€â”€â”€ /circles?domainId=[id]
        â”œâ”€â”€ Flows Tab â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ /flows?domainId=[id]
        â”œâ”€â”€ Resources Tab â”€â”€â”€â”€â”€â”€ /resources?domainId=[id]
        â””â”€â”€ Settings Tab

/circles
    â”œâ”€â”€ /circles?domainId=[id] â”€â”€â”€ View circles for domain
    â”œâ”€â”€ /circles/create â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create new circle
    â””â”€â”€ /circles/[id]
        â”œâ”€â”€ Members â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ /circles/[id]/members
        â””â”€â”€ Settings

/flows (Work Items / Tickets)
    â”œâ”€â”€ /flows?domainId=[id] â”€â”€â”€â”€ View flows for domain
    â”œâ”€â”€ /flows/create â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create new flow
    â””â”€â”€ /flows/[id]
        â”œâ”€â”€ Details
        â”œâ”€â”€ Comments
        â”œâ”€â”€ Stage History â”€â”€â”€â”€â”€â”€ (Q â†’ U â†’ A â†’ D transitions)
        â”œâ”€â”€ Branch Info â”€â”€â”€â”€â”€â”€â”€â”€ /flows/[id]/branch
        â””â”€â”€ Pull Request â”€â”€â”€â”€â”€â”€â”€ /flows/[id]/pull-request

/tickets
    â”œâ”€â”€ /tickets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ All tickets
    â”œâ”€â”€ /tickets/create â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create ticket
    â””â”€â”€ /tickets/[id]
        â”œâ”€â”€ Details
        â”œâ”€â”€ Comments â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ /tickets/[id]/comments
        â”œâ”€â”€ Time Logs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ /tickets/[id]/time-logs
        â””â”€â”€ AI Analysis â”€â”€â”€â”€â”€â”€â”€â”€ /tickets/[id]/analyze

/requirements
    â”œâ”€â”€ /requirements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ All requirements
    â”œâ”€â”€ /requirements/create â”€â”€â”€â”€ Create requirement
    â””â”€â”€ /requirements/[id]
        â”œâ”€â”€ Details
        â”œâ”€â”€ AI Analysis â”€â”€â”€â”€â”€â”€â”€â”€ /requirements/[id]/analyze
        â””â”€â”€ Generate Tickets â”€â”€â”€ /requirements/[id]/generate-tickets

/roles
    â”œâ”€â”€ /roles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ All roles
    â”œâ”€â”€ /roles/create â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create custom role
    â””â”€â”€ /roles/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Edit role

/setup (Onboarding Wizard)
    â”œâ”€â”€ /setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Setup overview
    â”œâ”€â”€ /setup/ai-tier â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Select AI tier
    â”œâ”€â”€ /setup/meetings â”€â”€â”€â”€â”€â”€â”€â”€â”€ Configure meeting integrations
    â””â”€â”€ /setup/complete â”€â”€â”€â”€â”€â”€â”€â”€â”€ Setup complete

/configure (Configuration Hub)
    â”œâ”€â”€ /configure â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Config overview
    â”œâ”€â”€ /configure/integrations â”€ Integration settings
    â”‚   â””â”€â”€ /configure/integrations/git â”€ Git provider setup
    â””â”€â”€ /configure/admin/byok â”€â”€â”€ Bring Your Own Key (BYOK) settings

/blueprint-agent
    â””â”€â”€ Interactive UI for Blueprint Agent interviews
        â”œâ”€â”€ Start Interview â”€â”€â”€â”€â”€â”€â”€ POST /api/blueprint-agent/start-interview
        â””â”€â”€ Submit Answer â”€â”€â”€â”€â”€â”€â”€â”€â”€ POST /api/blueprint-agent/submit-answer

/reporting
    â””â”€â”€ Analytics Dashboard
        â”œâ”€â”€ Team Velocity â”€â”€â”€â”€â”€â”€â”€â”€â”€ /api/dashboard/velocity
        â”œâ”€â”€ Cycle Burndown â”€â”€â”€â”€â”€â”€â”€â”€ /api/dashboard/cycles/[id]/burndown
        â””â”€â”€ Team Performance â”€â”€â”€â”€â”€â”€ /api/dashboard/team

/tools
    â”œâ”€â”€ /tools â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Available tools
    â””â”€â”€ /tools/request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Request new tool
```

---

## API Endpoints

### Public API (No Auth Required)

```
GET  /api/health â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Health check
GET  /api/auth/providers â”€â”€â”€â”€â”€â”€â”€â”€ List available OAuth providers
GET  /api/auth/sso-config â”€â”€â”€â”€â”€â”€â”€â”€ Get SSO config for domain
POST /api/auth/send-code â”€â”€â”€â”€â”€â”€â”€â”€ Send email verification code
POST /api/auth/verify-code â”€â”€â”€â”€â”€â”€â”€ Verify email code
POST /api/auth/signup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create new user account
POST /api/auth/complete-oauth-signup â”€ Complete OAuth signup
GET  /api/book/database â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Download Database Design Book
GET  /api/book/nextjs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Download Next.js Book
```

### Protected API (Requires Authentication)

#### Authentication & Users
```
GET  /api/users â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ List users
GET  /api/users/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get user by ID
POST /api/auth/logout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Logout current user
GET  /api/auth/user-domains â”€â”€â”€â”€â”€â”€â”€ Get user's domains
POST /api/auth/set-domain â”€â”€â”€â”€â”€â”€â”€â”€ Set active domain
```

#### Companies & Organizations
```
GET  /api/companies â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ List companies
GET  /api/companies/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get company by ID
GET  /api/company/profile â”€â”€â”€â”€â”€â”€â”€â”€ Current company profile
```

#### Domains
```
GET  /api/domains/list â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ List user's domains
POST /api/domains/create â”€â”€â”€â”€â”€â”€â”€â”€ Create new domain
GET  /api/domains/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get domain by ID
PUT  /api/domains/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Update domain
GET  /api/domains/[id]/members â”€â”€â”€ Get domain members
POST /api/domains/[id]/members â”€â”€ Add domain member
```

#### Circles
```
GET  /api/circles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ List circles
POST /api/circles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create circle
GET  /api/circles/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get circle
PUT  /api/circles/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Update circle
GET  /api/circles/[id]/members â”€â”€ Get circle members
POST /api/circles/[id]/members â”€â”€ Add circle member
```

#### Flows & Tickets
```
GET  /api/flows â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ List flows
POST /api/flows â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create flow
GET  /api/flows/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get flow
PUT  /api/flows/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Update flow
POST /api/flows/[id]/branch â”€â”€â”€â”€â”€â”€ Create git branch
POST /api/flows/[id]/pull-request â”€ Create PR

GET  /api/tickets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ List tickets
POST /api/tickets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create ticket
GET  /api/tickets/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get ticket
PUT  /api/tickets/[id] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Update ticket
POST /api/tickets/[id]/analyze â”€â”€ AI analysis
POST /api/tickets/[id]/comments â”€ Add comment
GET  /api/tickets/[id]/time-logs â”€ Get time logs
POST /api/tickets/[id]/time-logs â”€ Log time
```

#### Requirements
```
GET  /api/requirements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ List requirements
POST /api/requirements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Create requirement
GET  /api/requirements/[id] â”€â”€â”€â”€â”€â”€ Get requirement
POST /api/requirements/[id]/analyze â”€â”€â”€â”€â”€â”€â”€â”€ AI analysis
POST /api/requirements/[id]/generate-tickets â”€ Generate tickets
```

#### AI & Chat
```
POST /api/ai/chat â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Send chat message
POST /api/ai/chat/stream â”€â”€â”€â”€â”€â”€â”€â”€ Stream chat response
POST /api/ai/ticket-chat â”€â”€â”€â”€â”€â”€â”€â”€ Ticket-specific chat
GET  /api/ai/usage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get AI usage stats
GET  /api/ai/credits â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get AI credits
GET  /api/ai-config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get AI configuration
POST /api/ai-config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Update AI config
```

#### Integrations
```
GET  /api/integrations/git/providers â”€â”€â”€â”€â”€â”€ List git providers
GET  /api/integrations/git/status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Git integration status
GET  /api/integrations/git/repositories â”€â”€â”€â”€ List repositories
POST /api/integrations/git/[provider]/connect â”€â”€â”€ Connect git
GET  /api/integrations/git/[provider]/callback â”€ OAuth callback
POST /api/integrations/git/[provider]/disconnect â”€ Disconnect

GET  /api/integrations/meeting/providers â”€ List meeting providers
GET  /api/integrations/meeting/status â”€â”€â”€â”€â”€ Meeting integration status
POST /api/integrations/meeting/[provider]/connect â”€â”€â”€ Connect
GET  /api/integrations/meeting/[provider]/callback â”€ OAuth callback
POST /api/integrations/meeting/[provider]/webhook â”€ Meeting webhook
```

#### Blueprint Agent
```
POST /api/blueprint-agent/start-interview â”€ Start AI interview
POST /api/blueprint-agent/submit-answer â”€â”€â”€ Submit interview answer
```

#### Admin & Configuration
```
GET  /api/admin/byok â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get BYOK settings
POST /api/admin/byok â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Update BYOK settings
GET  /api/admin/ai-pool â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Get AI pool config
POST /api/admin/ai-pool â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Update AI pool
```

---

## Navigation Rules

### Redirect Logic

| Condition | Action |
|-----------|--------|
| Unauthenticated user accesses protected page | â†’ `/auth/login` |
| Authenticated user accesses `/auth/login` | â†’ Stay (no redirect) |
| Authenticated user accesses `/auth/signup` | â†’ Stay (no redirect) âš ï¸ |
| New OAuth user (no account) | â†’ `/auth/signup?oauth=true&...` |
| Existing OAuth user (has account) | â†’ `/dashboard` âœ… |
| User completes signup | â†’ `/dashboard` |
| User logs out | â†’ `/auth/login` |

### Session Management

- **Session Strategy:** JWT tokens stored in cookies
- **Session Duration:** 24 hours (NextAuth default)
- **Token Refresh:** Automatic on page load
- **Logout:** Clears session cookie, redirects to login

### Domain Context

- Users can belong to multiple domains (projects)
- Active domain stored in session (`session.user.domainId`)
- Dashboard shows all accessible domains
- Switching domains: `POST /api/auth/set-domain`

---

## OAuth Provider Flow Details

### Google OAuth Flow

```
1. User clicks "Continue with Google"
   â†’ Frontend: signIn('google', { callbackUrl: '/dashboard' })

2. NextAuth redirects to Google
   â†’ https://accounts.google.com/o/oauth2/v2/auth?...

3. User approves â†’ Google redirects back
   â†’ http://localhost:14001/api/auth/callback/google?code=...

4. NextAuth callback (authOptions.ts)
   â†’ signIn() callback runs
   â†’ Checks getUserByEmail()
   â†’ Returns redirect URL or true

5. Final redirect
   â†’ Existing user: /dashboard
   â†’ New user: /auth/signup?oauth=true&...
```

### GitHub OAuth Flow

(Same as Google, replace `google` with `github`)

---

## Error Pages & Special Routes

```
/auth/login?error=... â”€â”€â”€â”€â”€â”€â”€â”€â”€ OAuth error (shows error message)
/404 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Page not found
/_not-found â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Next.js 404 handler
/api/auth/error â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NextAuth error page
```

---

## Summary: Key Flow Fixes (Jan 4, 2026)

### âœ… Fixed Issues

1. **Invisible Input Text**
   - **Page:** `/auth/login`
   - **Issue:** Email and code inputs had no text color
   - **Fix:** Added `text-gray-900 placeholder:text-gray-400`
   - **File:** `src/app/auth/login/page.tsx`

2. **OAuth Signup Loop (Existing Users)**
   - **Issue:** Existing user clicks "Sign Up" â†’ OAuth â†’ redirects back to signup â†’ loop
   - **Fix:** Changed `return true` to `return '/dashboard'` for existing users
   - **File:** `src/lib/authOptions.ts:109`
   - **Impact:** Existing users now skip signup flow and go directly to dashboard

### âš ï¸ Known Inefficiencies (Not Bugs)

1. **Two OAuth Roundtrips for New Users**
   - New user signup requires 2 OAuth calls (one to detect new user, one to create session)
   - Not a bug, just architectural choice
   - Google auto-approves 2nd OAuth (no consent screen shown twice)

2. **No Logged-In User Redirect on Signup Page**
   - Logged-in users can still access `/auth/signup`
   - Should redirect to dashboard
   - Low priority UX improvement

---

**Last Updated:** January 4, 2026
**Author:** Suman Addanki (via Claude Code)
**Version:** 1.0
