# QUAD Agent Configuration
# ========================
#
# This file configures the QUAD Agent Runtime (QAR)
# Place this as `quad.config.yaml` in your project root
#
# Part of QUAD™ (Quick Unified Agentic Development) Methodology
# © 2025 Suman Addanke / A2 Vibe Creators LLC

version: "1.0"
project: "my-project"

# =============================================================================
# DEFAULT SETTINGS
# =============================================================================

# Default timeout for agent invocations (in milliseconds)
defaultTimeout: 60000

# Default execution mode: SEQUENTIAL | PARALLEL | HYBRID
defaultMode: HYBRID

# =============================================================================
# INVOCATION METHODS
# =============================================================================
# Enable/disable different ways to trigger agents

invocation:
  ide: true       # VS Code, Cursor, etc.
  cli: true       # Command line: quad agent invoke ...
  chat: true      # Claude, Copilot chat interface
  auto: true      # CI/CD, git hooks, automated triggers
  mcp: true       # Model Context Protocol (Claude Desktop)

# =============================================================================
# PIPELINES
# =============================================================================
# Define agent pipelines for common workflows

pipelines:
  # ---------------------------------------------------------------------------
  # Estimation Pipeline (SEQUENTIAL)
  # ---------------------------------------------------------------------------
  # Multi-agent estimation using Platonic Solid scale
  #
  # Flow:
  #   Code Agent → DB Agent → Flow Agent → Estimation Agent
  #        ↓           ↓           ↓              ↓
  #   code_score   db_score   flow_score   final_estimate
  #
  estimation:
    description: "Multi-agent complexity estimation"
    version: "1.0.0"
    mode: SEQUENTIAL
    timeout: 120000
    steps:
      - agentId: code-agent
        requiredOutput: code_complexity
        timeout: 30000
      - agentId: db-agent
        requiredOutput: db_impact
        timeout: 30000
      - agentId: flow-agent
        requiredOutput: flow_complexity
        timeout: 30000
      - agentId: estimation-agent
        requiredOutput: final_estimate
        timeout: 30000

  # ---------------------------------------------------------------------------
  # Development Pipeline (HYBRID)
  # ---------------------------------------------------------------------------
  # Full development cycle with parallel stages
  #
  # Flow:
  #   Stage 1: [Dev UI + Dev API] (parallel)
  #            ↓ (wait for both)
  #   Stage 2: [Test UI + Test API] (parallel)
  #            ↓ (wait for both)
  #   Stage 3: [Review Agent] (sequential)
  #
  development:
    description: "Full development cycle with parallel stages"
    version: "1.0.0"
    mode: HYBRID
    stages:
      - name: development
        agents:
          - dev-agent-ui
          - dev-agent-api
        parallel: true
        waitForAll: true

      - name: testing
        agents:
          - test-agent-ui
          - test-agent-api
        parallel: true
        waitForAll: true

      - name: review
        agents:
          - review-agent
        parallel: false

  # ---------------------------------------------------------------------------
  # Code Review Pipeline (SEQUENTIAL)
  # ---------------------------------------------------------------------------
  code-review:
    description: "Automated code review"
    version: "1.0.0"
    mode: SEQUENTIAL
    steps:
      - agentId: security-scanner-agent
        optional: true
      - agentId: code-review-agent
        requiredOutput: review_comments
      - agentId: a11y-scanner-agent
        optional: true

# =============================================================================
# PERMISSIONS
# =============================================================================
# Override default agent permissions per project

permissions:
  # ---------------------------------------------------------------------------
  # Dev Agent UI - Can only write to UI files
  # ---------------------------------------------------------------------------
  dev-agent-ui:
    canRead:
      - "src/**"
      - "stories/**"
    canWrite:
      - "src/ui/**"
      - "src/components/**"
      - "tests/ui/**"
    cannotWrite:
      - "src/api/**"
      - "database/**"
    canInvoke:
      - test-agent-ui
      - review-agent

  # ---------------------------------------------------------------------------
  # Dev Agent API - Can only write to API files
  # ---------------------------------------------------------------------------
  dev-agent-api:
    canRead:
      - "src/**"
      - "database/schema/**"
      - "stories/**"
    canWrite:
      - "src/api/**"
      - "src/services/**"
      - "src/dto/**"
      - "tests/api/**"
    cannotWrite:
      - "src/ui/**"
      - "database/data/**"
    canInvoke:
      - test-agent-api
      - review-agent

  # ---------------------------------------------------------------------------
  # Deploy Agent DEV - No approval needed
  # ---------------------------------------------------------------------------
  deploy-agent-dev:
    canInvoke: []  # Terminal agent - cannot invoke others
    requiresApproval: false

  # ---------------------------------------------------------------------------
  # Deploy Agent PROD - REQUIRES HUMAN APPROVAL
  # ---------------------------------------------------------------------------
  deploy-agent-prod:
    canInvoke: []  # Terminal agent
    requiresApproval: true  # CRITICAL: Human must approve

# =============================================================================
# AUDIT SETTINGS
# =============================================================================

audit:
  enabled: true
  retentionDays: 90

  # Fields to redact in audit logs (security)
  sensitiveFields:
    - password
    - token
    - secret
    - apiKey
    - authorization

# =============================================================================
# SHARED CONTEXT
# =============================================================================

context:
  maxKeys: 10000
  maxValueSize: 1048576  # 1MB
  enablePersistence: false

# =============================================================================
# EVENT BUS
# =============================================================================

events:
  maxQueueSize: 10000
  eventRetentionMs: 3600000  # 1 hour
  enableReplay: true
  logEvents: false  # Set to true for debugging
